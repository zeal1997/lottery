{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  name: 'LoginForm',\n  data() {\n    return {\n      phone: '',\n      password: '',\n      error: ''\n    };\n  },\n  methods: {\n    async handleLogin() {\n      // 前端验证\n      if (!/^1[3-9]\\d{9}$/.test(this.phone)) {\n        this.error = '请输入有效的手机号';\n        return;\n      }\n      if (this.password !== this.phone.slice(-6)) {\n        this.error = '密码必须是手机号后六位';\n        return;\n      }\n      try {\n        const response = await fetch('http://localhost:3001/api/login', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({\n            phone: this.phone,\n            password: this.password\n          })\n        });\n        const data = await response.json();\n        if (data.success) {\n          this.$store.commit('setUser', data.user);\n          this.$store.commit('setHasDrawn', data.user.hasDrawn);\n          if (data.user.winningPrize) {\n            this.$store.commit('setWinningPrize', data.user.winningPrize);\n          }\n          this.$router.push(data.user.hasDrawn ? '/result' : '/lottery');\n        } else {\n          this.error = data.error;\n        }\n      } catch (error) {\n        this.error = '网络错误，请稍后重试';\n        console.error('登录错误:', error);\n      }\n    }\n  }\n};","map":{"version":3,"names":["name","data","phone","password","error","methods","handleLogin","test","slice","response","fetch","method","headers","body","JSON","stringify","json","success","$store","commit","user","hasDrawn","winningPrize","$router","push","console"],"sources":["/Users/jackie/Documents/vue/lottery/src/components/Login.vue"],"sourcesContent":["<template>\n  <div class=\"login-container\">\n    <h2>富阳校园抽奖系统</h2>\n    <form @submit.prevent=\"handleLogin\">\n      <div class=\"form-group\">\n        <label>手机号：</label>\n        <input \n          type=\"text\" \n          v-model=\"phone\" \n          placeholder=\"请输入手机号\"\n          pattern=\"^1[3-9]\\d{9}$\"\n          required\n        >\n      </div>\n      <div class=\"form-group\">\n        <label>密码：</label>\n        <input \n          type=\"password\" \n          v-model=\"password\" \n          placeholder=\"请输入手机号后六位\"\n          pattern=\"^\\d{6}$\"\n          required\n        >\n      </div>\n      <button type=\"submit\" class=\"login-btn\">登录</button>\n      <div v-if=\"error\" class=\"error-message\">{{ error }}</div>\n    </form>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'LoginForm',\n  data() { return { phone: '', password: '', error: '' }},\n  methods: {\n    async handleLogin() {\n      // 前端验证\n      if (!/^1[3-9]\\d{9}$/.test(this.phone)) {\n        this.error = '请输入有效的手机号'\n        return\n      }\n      if (this.password !== this.phone.slice(-6)) {\n        this.error = '密码必须是手机号后六位'\n        return\n      }\n\n      try {\n        const response = await fetch('http://localhost:3001/api/login', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\n            phone: this.phone,\n            password: this.password\n          })\n        })\n        \n        const data = await response.json()\n        \n        if (data.success) {\n          this.$store.commit('setUser', data.user)\n          this.$store.commit('setHasDrawn', data.user.hasDrawn)\n          if (data.user.winningPrize) {\n            this.$store.commit('setWinningPrize', data.user.winningPrize)\n          }\n          this.$router.push(data.user.hasDrawn ? '/result' : '/lottery')\n        } else {\n          this.error = data.error\n        }\n      } catch (error) {\n        this.error = '网络错误，请稍后重试'\n        console.error('登录错误:', error)\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.login-container {\n  max-width: 400px;\n  margin: 100px auto;\n  padding: 30px;\n  background-color: white;\n  border-radius: 10px;\n  box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);\n  text-align: center;\n}\n\nh2 {\n  color: #333;\n  margin-bottom: 30px;\n  font-weight: 500;\n}\n\n.form-group {\n  margin-bottom: 20px;\n  text-align: left;\n}\n\nlabel {\n  display: block;\n  margin-bottom: 8px;\n  color: #666;\n  font-size: 14px;\n}\n\ninput {\n  width: 90%;\n  padding: 12px 15px;\n  border: 1px solid #ddd;\n  border-radius: 5px;\n  font-size: 16px;\n  transition: border-color 0.3s;\n}\n\ninput:focus {\n  outline: none;\n  border-color: #42b983;\n  box-shadow: 0 0 0 2px rgba(66, 185, 131, 0.2);\n}\n\n.login-btn {\n  width: 100%;\n  padding: 14px;\n  background-color: #42b983;\n  color: white;\n  border: none;\n  border-radius: 5px;\n  font-size: 16px;\n  cursor: pointer;\n  transition: background-color 0.3s;\n}\n\n.login-btn:hover {\n  background-color: #359469;\n}\n\n.error-message {\n  color: #ff4444;\n  margin-top: 15px;\n  font-size: 14px;\n  text-align: left;\n}\n</style>"],"mappings":";AA+BA,eAAe;EACbA,IAAI,EAAE,WAAW;EACjBC,IAAIA,CAAA,EAAG;IAAE,OAAO;MAAEC,KAAK,EAAE,EAAE;MAAEC,QAAQ,EAAE,EAAE;MAAEC,KAAK,EAAE;IAAG,CAAC;EAAA,CAAC;EACvDC,OAAO,EAAE;IACP,MAAMC,WAAWA,CAAA,EAAG;MAClB;MACA,IAAI,CAAC,eAAe,CAACC,IAAI,CAAC,IAAI,CAACL,KAAK,CAAC,EAAE;QACrC,IAAI,CAACE,KAAI,GAAI,WAAU;QACvB;MACF;MACA,IAAI,IAAI,CAACD,QAAO,KAAM,IAAI,CAACD,KAAK,CAACM,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE;QAC1C,IAAI,CAACJ,KAAI,GAAI,aAAY;QACzB;MACF;MAEA,IAAI;QACF,MAAMK,QAAO,GAAI,MAAMC,KAAK,CAAC,iCAAiC,EAAE;UAC9DC,MAAM,EAAE,MAAM;UACdC,OAAO,EAAE;YACP,cAAc,EAAE;UAClB,CAAC;UACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;YACnBb,KAAK,EAAE,IAAI,CAACA,KAAK;YACjBC,QAAQ,EAAE,IAAI,CAACA;UACjB,CAAC;QACH,CAAC;QAED,MAAMF,IAAG,GAAI,MAAMQ,QAAQ,CAACO,IAAI,CAAC;QAEjC,IAAIf,IAAI,CAACgB,OAAO,EAAE;UAChB,IAAI,CAACC,MAAM,CAACC,MAAM,CAAC,SAAS,EAAElB,IAAI,CAACmB,IAAI;UACvC,IAAI,CAACF,MAAM,CAACC,MAAM,CAAC,aAAa,EAAElB,IAAI,CAACmB,IAAI,CAACC,QAAQ;UACpD,IAAIpB,IAAI,CAACmB,IAAI,CAACE,YAAY,EAAE;YAC1B,IAAI,CAACJ,MAAM,CAACC,MAAM,CAAC,iBAAiB,EAAElB,IAAI,CAACmB,IAAI,CAACE,YAAY;UAC9D;UACA,IAAI,CAACC,OAAO,CAACC,IAAI,CAACvB,IAAI,CAACmB,IAAI,CAACC,QAAO,GAAI,SAAQ,GAAI,UAAU;QAC/D,OAAO;UACL,IAAI,CAACjB,KAAI,GAAIH,IAAI,CAACG,KAAI;QACxB;MACF,EAAE,OAAOA,KAAK,EAAE;QACd,IAAI,CAACA,KAAI,GAAI,YAAW;QACxBqB,OAAO,CAACrB,KAAK,CAAC,OAAO,EAAEA,KAAK;MAC9B;IACF;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}