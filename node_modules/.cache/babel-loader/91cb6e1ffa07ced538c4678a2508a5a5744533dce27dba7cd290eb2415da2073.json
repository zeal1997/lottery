{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport \"core-js/modules/es.iterator.reduce.js\";\nimport { createStore } from 'vuex';\nexport default createStore({\n  state: {\n    user: null,\n    prizes: [{\n      id: 1,\n      name: '360话费',\n      count: 5,\n      probability: 5\n    }, {\n      id: 2,\n      name: '咖啡券',\n      count: 60,\n      probability: 15\n    }, {\n      id: 3,\n      name: '充电宝',\n      count: 30,\n      probability: 10\n    }, {\n      id: 4,\n      name: '卡套插线板',\n      count: 30,\n      probability: 10\n    }, {\n      id: 5,\n      name: '网红小夜灯',\n      count: 30,\n      probability: 10\n    }, {\n      id: 6,\n      name: '小风扇',\n      count: 50,\n      probability: 15\n    }, {\n      id: 7,\n      name: '泡面碗',\n      count: 30,\n      probability: 10\n    }, {\n      id: 8,\n      name: '轻奢水杯',\n      count: 30,\n      probability: 10\n    }, {\n      id: 9,\n      name: '炫彩雨伞',\n      count: 50,\n      probability: 15\n    }],\n    hasDrawn: false,\n    winningPrize: null\n  },\n  mutations: {\n    setUser(state, user) {\n      state.user = user;\n    },\n    setHasDrawn(state, status) {\n      state.hasDrawn = status;\n    },\n    setWinningPrize(state, prize) {\n      state.winningPrize = prize;\n    },\n    decreasePrizeCount(state, prizeId) {\n      const prize = state.prizes.find(p => p.id === prizeId);\n      if (prize && prize.count > 0) prize.count--;\n    }\n  },\n  actions: {\n    // 登录验证\n    login({\n      commit\n    }, {\n      phone,\n      password\n    }) {\n      // 这里使用模拟数据，实际项目需要替换为API调用\n      const validPhones = ['13800138000', '13900139000']; // 示例有效手机号\n      if (validPhones.includes(phone) && password === phone.slice(-6)) {\n        commit('setUser', {\n          phone\n        });\n        const hasDrawn = localStorage.getItem(`hasDrawn_${phone}`) === 'true';\n        commit('setHasDrawn', hasDrawn);\n        return true;\n      }\n      return false;\n    },\n    // 抽奖逻辑\n    drawPrize({\n      state,\n      commit\n    }) {\n      if (state.hasDrawn) return null;\n\n      // 计算可用奖品和总权重\n      const availablePrizes = state.prizes.filter(p => p.count > 0);\n      const totalWeight = availablePrizes.reduce((sum, p) => sum + p.probability, 0);\n\n      // 随机抽取奖品\n      const random = Math.random() * totalWeight;\n      let currentWeight = 0;\n      let winningPrize = null;\n      for (const prize of availablePrizes) {\n        currentWeight += prize.probability;\n        if (random <= currentWeight) {\n          winningPrize = prize;\n          break;\n        }\n      }\n      if (winningPrize) {\n        commit('decreasePrizeCount', winningPrize.id);\n        commit('setWinningPrize', winningPrize);\n        commit('setHasDrawn', true);\n        localStorage.setItem(`hasDrawn_${state.user.phone}`, 'true');\n        localStorage.setItem(`winningPrize_${state.user.phone}`, JSON.stringify(winningPrize));\n      }\n      return winningPrize;\n    }\n  }\n});","map":{"version":3,"names":["createStore","state","user","prizes","id","name","count","probability","hasDrawn","winningPrize","mutations","setUser","setHasDrawn","status","setWinningPrize","prize","decreasePrizeCount","prizeId","find","p","actions","login","commit","phone","password","validPhones","includes","slice","localStorage","getItem","drawPrize","availablePrizes","filter","totalWeight","reduce","sum","random","Math","currentWeight","setItem","JSON","stringify"],"sources":["/Users/jackie/Documents/vue/lottery/src/store/index.js"],"sourcesContent":["import { createStore } from 'vuex'\n\nexport default createStore({  \n  state: {\n    user: null,\n    prizes: [\n      { id: 1, name: '360话费', count: 5, probability: 5 },\n      { id: 2, name: '咖啡券', count: 60, probability: 15 },\n      { id: 3, name: '充电宝', count: 30, probability: 10 },\n      { id: 4, name: '卡套插线板', count: 30, probability: 10 },\n      { id: 5, name: '网红小夜灯', count: 30, probability: 10 },\n      { id: 6, name: '小风扇', count: 50, probability: 15 },\n      { id: 7, name: '泡面碗', count: 30, probability: 10 },\n      { id: 8, name: '轻奢水杯', count: 30, probability: 10 },\n      { id: 9, name: '炫彩雨伞', count: 50, probability: 15 }\n    ],\n    hasDrawn: false,\n    winningPrize: null\n  },\n  mutations: {\n    setUser(state, user) { state.user = user },\n    setHasDrawn(state, status) { state.hasDrawn = status },\n    setWinningPrize(state, prize) { state.winningPrize = prize },\n    decreasePrizeCount(state, prizeId) {\n      const prize = state.prizes.find(p => p.id === prizeId)\n      if (prize && prize.count > 0) prize.count--\n    }\n  },\n  actions: {\n    // 登录验证\n    login({ commit }, { phone, password }) {\n      // 这里使用模拟数据，实际项目需要替换为API调用\n      const validPhones = ['13800138000', '13900139000'] // 示例有效手机号\n      if (validPhones.includes(phone) && password === phone.slice(-6)) {\n        commit('setUser', { phone })\n        const hasDrawn = localStorage.getItem(`hasDrawn_${phone}`) === 'true'\n        commit('setHasDrawn', hasDrawn)\n        return true\n      }\n      return false\n    },\n    // 抽奖逻辑\n    drawPrize({ state, commit }) {\n      if (state.hasDrawn) return null\n\n      // 计算可用奖品和总权重\n      const availablePrizes = state.prizes.filter(p => p.count > 0)\n      const totalWeight = availablePrizes.reduce((sum, p) => sum + p.probability, 0)\n\n      // 随机抽取奖品\n      const random = Math.random() * totalWeight\n      let currentWeight = 0\n      let winningPrize = null\n\n      for (const prize of availablePrizes) {\n        currentWeight += prize.probability\n        if (random <= currentWeight) {\n          winningPrize = prize\n          break\n        }\n      }\n\n      if (winningPrize) {\n        commit('decreasePrizeCount', winningPrize.id)\n        commit('setWinningPrize', winningPrize)\n        commit('setHasDrawn', true)\n        localStorage.setItem(`hasDrawn_${state.user.phone}`, 'true')\n        localStorage.setItem(`winningPrize_${state.user.phone}`, JSON.stringify(winningPrize))\n      }\n\n      return winningPrize\n    }\n  }\n})"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}