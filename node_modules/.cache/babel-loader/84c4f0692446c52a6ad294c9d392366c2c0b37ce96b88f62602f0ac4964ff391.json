{"ast":null,"code":"import { createElementVNode as _createElementVNode, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, normalizeStyle as _normalizeStyle, normalizeClass as _normalizeClass } from \"vue\";\nconst _hoisted_1 = {\n  class: \"lottery-container\"\n};\nconst _hoisted_2 = {\n  class: \"wheel-wrapper\"\n};\nconst _hoisted_3 = {\n  class: \"prize-name\"\n};\nconst _hoisted_4 = [\"disabled\"];\nconst _hoisted_5 = {\n  key: 0,\n  class: \"result-modal\"\n};\nconst _hoisted_6 = {\n  class: \"modal-content\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[4] || (_cache[4] = _createElementVNode(\"h2\", null, \"幸运大转盘\", -1 /* CACHED */)), _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", {\n    class: _normalizeClass([\"wheel\", {\n      spinning: $data.isSpinning\n    }]),\n    style: _normalizeStyle(_ctx.wheelStyle)\n  }, [_createCommentVNode(\" 转盘扇区 \"), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($options.availablePrizes, (prize, index) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: prize.id,\n      class: \"wheel-sector\",\n      style: _normalizeStyle($options.getSectorStyle(index))\n    }, [_createElementVNode(\"span\", _hoisted_3, _toDisplayString(prize.name), 1 /* TEXT */)], 4 /* STYLE */);\n  }), 128 /* KEYED_FRAGMENT */)), _cache[2] || (_cache[2] = _createElementVNode(\"div\", {\n    class: \"wheel-pointer\"\n  }, null, -1 /* CACHED */))], 6 /* CLASS, STYLE */)]), _createElementVNode(\"button\", {\n    class: \"draw-btn\",\n    onClick: _cache[0] || (_cache[0] = (...args) => $options.startDraw && $options.startDraw(...args)),\n    disabled: $data.isSpinning || $options.hasDrawn\n  }, _toDisplayString($data.isSpinning ? '抽奖中...' : '开始抽奖'), 9 /* TEXT, PROPS */, _hoisted_4), _createCommentVNode(\" 中奖弹窗 \"), $options.winningPrize ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_createElementVNode(\"div\", _hoisted_6, [_cache[3] || (_cache[3] = _createElementVNode(\"h3\", null, \"恭喜您中奖了！\", -1 /* CACHED */)), _createElementVNode(\"p\", null, \"奖品：\" + _toDisplayString($options.winningPrize.name), 1 /* TEXT */), _createElementVNode(\"button\", {\n    onClick: _cache[1] || (_cache[1] = (...args) => $options.closeResult && $options.closeResult(...args))\n  }, \"确定\")])])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_normalizeClass","spinning","$data","isSpinning","style","_normalizeStyle","_ctx","wheelStyle","_createCommentVNode","_Fragment","_renderList","$options","availablePrizes","prize","index","key","id","getSectorStyle","_hoisted_3","_toDisplayString","name","onClick","_cache","args","startDraw","disabled","hasDrawn","_hoisted_4","winningPrize","_hoisted_5","_hoisted_6","closeResult"],"sources":["/Users/jackie/Documents/vue/lottery/src/components/LotteryWheel.vue"],"sourcesContent":["<template>\n  <div class=\"lottery-container\">\n    <h2>幸运大转盘</h2>\n    <div class=\"wheel-wrapper\">\n      <div class=\"wheel\" :style=\"wheelStyle\" :class=\"{ spinning: isSpinning }\">\n        <!-- 转盘扇区 -->\n        <div v-for=\"(prize, index) in availablePrizes\" :key=\"prize.id\" class=\"wheel-sector\" :style=\"getSectorStyle(index)\">\n          <span class=\"prize-name\">{{ prize.name }}</span>\n        </div>\n        <div class=\"wheel-pointer\"></div>\n      </div>\n    </div>\n    <button class=\"draw-btn\" @click=\"startDraw\" :disabled=\"isSpinning || hasDrawn\">\n      {{ isSpinning ? '抽奖中...' : '开始抽奖' }}\n    </button>\n    <!-- 中奖弹窗 -->\n    <div v-if=\"winningPrize\" class=\"result-modal\">\n      <div class=\"modal-content\">\n        <h3>恭喜您中奖了！</h3>\n        <p>奖品：{{ winningPrize.name }}</p>\n        <button @click=\"closeResult\">确定</button>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  data() { return { rotateDegree: 0, isSpinning: false, spinningTime: 5000 }},\n  computed: {\n    availablePrizes() { return this.$store.state.prizes.filter(p => p.count > 0) },\n    hasDrawn() { return this.$store.state.hasDrawn },\n    winningPrize() { return this.$store.state.winningPrize }\n  },\n  methods: {\n    getSectorStyle(index) {\n      const angle = 360 / this.availablePrizes.length\n      const startAngle = index * angle\n      const endAngle = startAngle + angle\n      const midAngle = (startAngle + endAngle) / 2 * Math.PI / 180\n      const radius = 100\n      // 移除未使用的变量\n      // const textOffset = 70\n      // const textAngle = midAngle * 180 / Math.PI\n    \n      return {\n        transform: `rotate(${startAngle}deg)`,\n        clipPath: `polygon(50% 50%, 50% 0%, ${50 + radius * Math.cos(midAngle)}% ${50 - radius * Math.sin(midAngle)}%)`,\n        backgroundColor: `hsl(${(index * 45) % 360}, 70%, 60%)`\n      }\n    },\n    startDraw() {\n      this.isSpinning = true\n      this.rotateDegree += 360 * 5 + Math.random() * 360 // 旋转5圈以上\n\n      // 抽奖结束后处理\n      setTimeout(() => {\n        this.isSpinning = false\n        this.$store.dispatch('drawPrize')\n      }, this.spinningTime)\n    },\n    closeResult() { this.$router.push('/result') }\n  }\n}\n</script>\n\n<style scoped>\n.lottery-container {\n  text-align: center;\n  padding: 20px;\n}\n\n.wheel-wrapper {\n  position: relative;\n  width: 300px;\n  height: 300px;\n  margin: 0 auto;\n}\n\n.wheel {\n  width: 100%;\n  height: 100%;\n  border-radius: 50%;\n  position: relative;\n  transition: transform 5s cubic-bezier(0.2, 0.8, 0.2, 1);\n  border: 5px solid #42b983;\n  overflow: hidden;\n}\n\n.wheel-sector {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  transform-origin: center bottom;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.prize-name {\n  position: absolute;\n  top: 20px;\n  width: 100px;\n  text-align: center;\n  transform-origin: center bottom;\n  font-size: 12px;\n  font-weight: bold;\n  color: #fff;\n  text-shadow: 1px 1px 2px rgba(0,0,0,0.5);\n}\n\n.wheel-pointer {\n  position: absolute;\n  top: -15px;\n  left: 50%;\n  transform: translateX(-50%);\n  width: 30px;\n  height: 30px;\n  background-color: #ff4d4f;\n  clip-path: polygon(50% 0%, 0% 100%, 100% 100%);\n  z-index: 10;\n}\n\n.draw-btn {\n  margin-top: 30px;\n  padding: 10px 30px;\n  background-color: #42b983;\n  color: white;\n  border: none;\n  border-radius: 20px;\n  font-size: 16px;\n  cursor: pointer;\n  outline: none;\n}\n\n.draw-btn:disabled {\n  background-color: #ccc;\n  cursor: not-allowed;\n}\n\n.result-modal {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0,0,0,0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.modal-content {\n  background-color: white;\n  padding: 30px;\n  border-radius: 10px;\n  text-align: center;\n}\n\n.modal-content button {\n  margin-top: 20px;\n  padding: 8px 20px;\n  background-color: #42b983;\n  color: white;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n}\n</style>"],"mappings":";;EACOA,KAAK,EAAC;AAAmB;;EAEvBA,KAAK,EAAC;AAAe;;EAIdA,KAAK,EAAC;AAAY;;;;EASLA,KAAK,EAAC;;;EACxBA,KAAK,EAAC;AAAe;;uBAhB9BC,mBAAA,CAsBM,OAtBNC,UAsBM,G,0BArBJC,mBAAA,CAAc,YAAV,OAAK,qBACTA,mBAAA,CAQM,OARNC,UAQM,GAPJD,mBAAA,CAMM;IANDH,KAAK,EAAAK,eAAA,EAAC,OAAO;MAAAC,QAAA,EAAyCC,KAAA,CAAAC;IAAU;IAAjDC,KAAK,EAAAC,eAAA,CAAEC,IAAA,CAAAC,UAAU;MACnCC,mBAAA,UAAa,G,kBACbZ,mBAAA,CAEMa,SAAA,QAAAC,WAAA,CAFwBC,QAAA,CAAAC,eAAe,GAAhCC,KAAK,EAAEC,KAAK;yBAAzBlB,mBAAA,CAEM;MAF0CmB,GAAG,EAAEF,KAAK,CAACG,EAAE;MAAErB,KAAK,EAAC,cAAc;MAAES,KAAK,EAAAC,eAAA,CAAEM,QAAA,CAAAM,cAAc,CAACH,KAAK;QAC9GhB,mBAAA,CAAgD,QAAhDoB,UAAgD,EAAAC,gBAAA,CAApBN,KAAK,CAACO,IAAI,iB;4DAExCtB,mBAAA,CAAiC;IAA5BH,KAAK,EAAC;EAAe,2B,2BAG9BG,mBAAA,CAES;IAFDH,KAAK,EAAC,UAAU;IAAE0B,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEZ,QAAA,CAAAa,SAAA,IAAAb,QAAA,CAAAa,SAAA,IAAAD,IAAA,CAAS;IAAGE,QAAQ,EAAEvB,KAAA,CAAAC,UAAU,IAAIQ,QAAA,CAAAe;sBAChExB,KAAA,CAAAC,UAAU,4CAAAwB,UAAA,GAEfnB,mBAAA,UAAa,EACFG,QAAA,CAAAiB,YAAY,I,cAAvBhC,mBAAA,CAMM,OANNiC,UAMM,GALJ/B,mBAAA,CAIM,OAJNgC,UAIM,G,0BAHJhC,mBAAA,CAAgB,YAAZ,SAAO,qBACXA,mBAAA,CAAiC,WAA9B,KAAG,GAAAqB,gBAAA,CAAGR,QAAA,CAAAiB,YAAY,CAACR,IAAI,kBAC1BtB,mBAAA,CAAwC;IAA/BuB,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEZ,QAAA,CAAAoB,WAAA,IAAApB,QAAA,CAAAoB,WAAA,IAAAR,IAAA,CAAW;KAAE,IAAE,E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}