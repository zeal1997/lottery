{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, withModifiers as _withModifiers } from \"vue\";\nconst _hoisted_1 = {\n  class: \"login-page\"\n};\nconst _hoisted_2 = {\n  class: \"login-container\"\n};\nconst _hoisted_3 = {\n  class: \"form-group\"\n};\nconst _hoisted_4 = {\n  class: \"form-group\"\n};\nconst _hoisted_5 = {\n  key: 0,\n  class: \"error-message\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_cache[6] || (_cache[6] = _createElementVNode(\"h2\", null, \"mobile校园回馈\", -1 /* CACHED */)), _createElementVNode(\"form\", {\n    onSubmit: _cache[2] || (_cache[2] = _withModifiers((...args) => $options.handleLogin && $options.handleLogin(...args), [\"prevent\"]))\n  }, [_createElementVNode(\"div\", _hoisted_3, [_cache[3] || (_cache[3] = _createElementVNode(\"label\", null, \"手机号：\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"text\",\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $data.phone = $event),\n    placeholder: \"请输入你申请的手机号\",\n    pattern: \"^1[3-9]\\\\d{9}$\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.phone]])]), _createElementVNode(\"div\", _hoisted_4, [_cache[4] || (_cache[4] = _createElementVNode(\"label\", null, \"密码：\", -1 /* CACHED */)), _withDirectives(_createElementVNode(\"input\", {\n    type: \"password\",\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.password = $event),\n    placeholder: \"默认密码为手机号后六位\",\n    pattern: \"^\\\\d{6}$\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.password]])]), _cache[5] || (_cache[5] = _createElementVNode(\"button\", {\n    type: \"submit\",\n    class: \"login-btn\"\n  }, \"登录\", -1 /* CACHED */)), $data.error ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, _toDisplayString($data.error), 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)], 32 /* NEED_HYDRATION */)])]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","onSubmit","_cache","_withModifiers","args","$options","handleLogin","_hoisted_3","type","$data","phone","$event","placeholder","pattern","required","_hoisted_4","password","error","_hoisted_5","_toDisplayString"],"sources":["/Users/jackie/Documents/vue/lottery/src/components/Login.vue"],"sourcesContent":["<template>\n  <div class=\"login-page\">\n    <div class=\"login-container\">\n      <h2>mobile校园回馈</h2>\n      <form @submit.prevent=\"handleLogin\">\n        <div class=\"form-group\">\n          <label>手机号：</label>\n          <input \n            type=\"text\" \n            v-model=\"phone\" \n            placeholder=\"请输入你申请的手机号\"\n            pattern=\"^1[3-9]\\d{9}$\"\n            required\n          >\n        </div>\n        <div class=\"form-group\">\n          <label>密码：</label>\n          <input \n            type=\"password\" \n            v-model=\"password\" \n            placeholder=\"默认密码为手机号后六位\"\n            pattern=\"^\\d{6}$\"\n            required\n          >\n        </div>\n        <button type=\"submit\" class=\"login-btn\">登录</button>\n        <div v-if=\"error\" class=\"error-message\">{{ error }}</div>\n      </form>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'LoginForm',\n  data() { return { phone: '', password: '', error: '' }},\n  methods: {\n    async handleLogin() {\n      // 前端验证\n      if (!/^1[3-9]\\d{9}$/.test(this.phone)) {\n        this.error = '请输入有效的手机号'\n        return\n      }\n      if (this.password !== this.phone.slice(-6)) {\n        this.error = '密码必须是手机号后六位'\n        return\n      }\n\n      try {\n        const response = await fetch('http://localhost:3001/api/login', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\n            phone: this.phone,\n            password: this.password\n          })\n        })\n        \n        const data = await response.json()\n        \n        if (data.success) {\n          this.$store.commit('setUser', data.user)\n          this.$store.commit('setHasDrawn', data.user.hasDrawn)\n          if (data.user.winningPrize) {\n            this.$store.commit('setWinningPrize', data.user.winningPrize)\n          }\n          this.$router.push(data.user.hasDrawn ? '/result' : '/lottery')\n        } else {\n          this.error = data.error\n        }\n      } catch (error) {\n        this.error = '网络错误，请稍后重试'\n        console.error('登录错误:', error)\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.login-page {\n  min-height: 100vh;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-image: url('@/assets/gift.png');\n  background-size: cover;\n  background-position: center;\n  background-repeat: no-repeat;\n  position: relative;\n}\n\n.login-page::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.4); /* 半透明遮罩，提高文字可读性 */\n}\n\n.login-container {\n  position: relative;\n  z-index: 1;\n  max-width: 520px;\n  margin: 100px auto;\n  padding: 30px;\n  background-color: rgba(255, 255, 255, 0.95);\n  border-radius: 10px;\n  box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);\n  text-align: center;\n  backdrop-filter: blur(5px);\n}\n\nh2 {\n  color: #333;\n  margin-bottom: 30px;\n  font-weight: 500;\n}\n\n.form-group {\n  margin-bottom: 20px;\n  text-align: left;\n}\n\nlabel {\n  display: block;\n  margin-bottom: 5px;\n  color: #555;\n  font-weight: 500;\n}\n\ninput {\n  width: 100%;\n  padding: 12px;\n  border: 1px solid #ddd;\n  border-radius: 5px;\n  font-size: 16px;\n  box-sizing: border-box;\n}\n\ninput:focus {\n  outline: none;\n  border-color: #3498db;\n  box-shadow: 0 0 5px rgba(52, 152, 219, 0.3);\n}\n\n.login-btn {\n  width: 100%;\n  padding: 12px;\n  background-color: #3498db;\n  color: white;\n  border: none;\n  border-radius: 5px;\n  font-size: 16px;\n  cursor: pointer;\n  transition: background-color 0.3s;\n}\n\n.login-btn:hover {\n  background-color: #2980b9;\n}\n\n.error-message {\n  color: #e74c3c;\n  margin-top: 10px;\n  font-size: 14px;\n}\n</style>"],"mappings":";;EACOA,KAAK,EAAC;AAAY;;EAChBA,KAAK,EAAC;AAAiB;;EAGnBA,KAAK,EAAC;AAAY;;EAUlBA,KAAK,EAAC;AAAY;;;EAWLA,KAAK,EAAC;;;uBAzB9BC,mBAAA,CA4BM,OA5BNC,UA4BM,GA3BJC,mBAAA,CA0BM,OA1BNC,UA0BM,G,0BAzBJD,mBAAA,CAAmB,YAAf,YAAU,qBACdA,mBAAA,CAuBO;IAvBAE,QAAM,EAAAC,MAAA,QAAAA,MAAA,MAAAC,cAAA,KAAAC,IAAA,KAAUC,QAAA,CAAAC,WAAA,IAAAD,QAAA,CAAAC,WAAA,IAAAF,IAAA,CAAW;MAChCL,mBAAA,CASM,OATNQ,UASM,G,0BARJR,mBAAA,CAAmB,eAAZ,MAAI,qB,gBACXA,mBAAA,CAMC;IALCS,IAAI,EAAC,MAAM;+DACFC,KAAA,CAAAC,KAAK,GAAAC,MAAA;IACdC,WAAW,EAAC,YAAY;IACxBC,OAAO,EAAC,gBAAe;IACvBC,QAAQ,EAAR;iDAHSL,KAAA,CAAAC,KAAK,E,KAMlBX,mBAAA,CASM,OATNgB,UASM,G,0BARJhB,mBAAA,CAAkB,eAAX,KAAG,qB,gBACVA,mBAAA,CAMC;IALCS,IAAI,EAAC,UAAU;+DACNC,KAAA,CAAAO,QAAQ,GAAAL,MAAA;IACjBC,WAAW,EAAC,aAAa;IACzBC,OAAO,EAAC,UAAS;IACjBC,QAAQ,EAAR;iDAHSL,KAAA,CAAAO,QAAQ,E,+BAMrBjB,mBAAA,CAAmD;IAA3CS,IAAI,EAAC,QAAQ;IAACZ,KAAK,EAAC;KAAY,IAAE,qBAC/Ba,KAAA,CAAAQ,KAAK,I,cAAhBpB,mBAAA,CAAyD,OAAzDqB,UAAyD,EAAAC,gBAAA,CAAdV,KAAA,CAAAQ,KAAK,oB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}